---
title: "R markdown file"
author: "Floris Meijvis en co"
date: "2024-11-22"
output: pdf_document
---

Importing packages:
```{r} 
library(ggplot2)
library(tidyverse)
library(spls)
library(tensorflow)
```

importing and editing data
```{r}
data(prostate)
x = prostate$x
y = prostate$y
Data = data.frame(x,y)
```
The prostate dataset consists of 52 prostate tumor and 50 normal samples. Normal and tumor classes are coded in 0 and 1, respectively, in y vector. Matrix x is gene expression data and arrays were normalized, log transformed, and standardized to zero mean and unit variance across genes as described in Dettling (2004) and Dettling and Beuhlmann (2002). See Chung and Keles (2010) for more details.

https://rdrr.io/cran/spls/man/prostate.html


making a few visualisations of the data
```{r}
Data %>%
  ggplot(aes(x = X1)) + 
  geom_boxplot() + 
  facet_wrap(vars(y))

Data %>%
  ggplot(aes(x = X2)) + 
  geom_boxplot() + 
  facet_wrap(vars(y))

Data %>%
  ggplot(aes(x = X3)) + 
  geom_boxplot() + 
  facet_wrap(vars(y))
```
A few quickly made observations: it seems that the tumors have less variance in the gene expressions (but this is based only on 3 plots, so could be wrong)

```{r}
#cell for doing logistic regression


```


```{r}
#cell for doing PCA
Data = as.matrix(Data) %>%
  scale(scale = FALSE)

Data.pca = prcomp(Data,
                  center = TRUE,
                  scale = TRUE)
summary(Data.pca)

Data.pca$x[,1] #gives scores of principal component 1 for all data points, these are used as the variables for fitting the logistic regression model.

```






```{r}
#cell for doing log.res. on Principal components


```




---
title: "R markdown file"
author: "Floris Meijvis en co"
date: "2024-11-22"
output: pdf_document
---

Importing packages:
```{r} 
library(ggplot2)
library(tidyverse)
library(spls)
```
# Importing and editing data
-> problem?! gene names are gone in Data dataframe
```{r}
# import and editing data
data(prostate)
x = prostate$x
y = prostate$y
Data = data.frame(x,y)

# rename column y to tumor
Data <- Data %>% rename(disease = y)

# explore data
nrow(Data) #102 samples -> 52 tumor samples, 50 normal tissue samples
ncol(Data) #6034 genes
class(Data)
head(Data)
```

The prostate dataset consists of 52 prostate tumor and 50 normal samples. Normal and tumor classes are coded in 0 and 1, respectively, in y vector. Matrix x is gene expression data and arrays were normalized, log transformed, and standardized to zero mean and unit variance across genes as described in Dettling (2004) and Dettling and Beuhlmann (2002). See Chung and Keles (2010) for more details.

https://rdrr.io/cran/spls/man/prostate.html

# Data visualization
```{r}
# making a few visualizations of the data
Data %>%
  ggplot(aes(x = X1)) + 
  geom_boxplot() + 
  facet_wrap(vars(y))

```

A few quickly made observations: it seems that the tumors have less variance in the gene expressions (but this is based only on 3 plots, so could be wrong)

```


# Logistic regression
```{r}
## TRAIN / TEST DATA SPLIT
# divide data in train/test data split (80/20%)
data_splits <- Data %>% mutate(splits = sample(rep(c("train", "test"), times = c(82, 20))))

# obtain individual train/test data set by filtering on splits column
train <- data_splits %>% filter(splits == "train")
test <- data_splits %>% filter(splits == "test")


## LOGISTIC REGRESSION 
# apply logistic regression on data
glm_genexp <- glm(y ~ ., family = "gaussian",
                  data = train %>% select(-splits))

# obtain predicted probabilities of train data
predict(glm_genexp, newdata = train, type = "response")



# obtain predicted probabilities of test data
predict(glm_genexp, newdata = test, type = "response")



```

# Principle component analysis (PCA)
```{r}
#cell for doing PCA



```



# Comparison of logistic regression and PCA
```{r}
#cell for doing log.res. on Principal components


```



